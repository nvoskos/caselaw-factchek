#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Reasoning Engine Module
Î•Î½ÏŒÏ„Î·Ï„Î± ÎœÎ·Ï‡Î±Î½Î®Ï‚ ÎÎ¿Î¼Î¹ÎºÎ®Ï‚ Î•ÏÎ¼Î·Î½ÎµÎ¯Î±Ï‚

Applies legal reasoning principles and generates alternative interpretations.
"""

import networkx as nx
from typing import Dict, List


class ReasoningEngine:
    """Applies statutory interpretation principles to analyze the legal question."""
    
    def __init__(self, articles: Dict, reference_graph: nx.DiGraph, verbose: bool = False):
        self.articles = articles
        self. graph = reference_graph
        self. verbose = verbose
    
    def analyze(self) -> Dict:
        """Main reasoning analysis."""
        results = {
            'primary_interpretation': {},
            'alternatives': [],
            'interpretation_principles': [],
            'ambiguities': [],
            'recommendations': []
        }
        
        # Define the primary interpretation being tested
        results['primary_interpretation'] = self._define_primary_interpretation()
        
        # Generate alternative interpretations
        results['alternatives'] = self._generate_alternatives()
        
        # Identify interpretation principles
        results['interpretation_principles'] = self._identify_principles()
        
        # Identify ambiguities
        results['ambiguities'] = self._identify_ambiguities()
        
        # Recommendations for resolving ambiguities
        results['recommendations'] = self._generate_recommendations()
        
        if self.verbose:
            print(f"   âœ“ Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ­Ï‚ ÎµÏÎ¼Î·Î½ÎµÎ¯ÎµÏ‚: {len(results['alternatives'])}")
        
        return results
    
    def _define_primary_interpretation(self) -> Dict:
        """Define the interpretation being fact-checked."""
        return {
            'statement': (
                "ÎŸ Î•Ï€Î¯ÏƒÎ·Î¼Î¿Ï‚ Î Î±ÏÎ±Î»Î®Ï€Ï„Î·Ï‚ ÏŒÏ†ÎµÎ¹Î»Îµ Î½Î± Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· "
                "Ï„Î¿Ï… Ï‡ÏÎµÏÏƒÏ„Î· ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Î·Ï‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±Ï‚ Ï„Ï‰Î½ 6 Î¼Î·Î½ÏÎ½"
            ),
            'english':  (
                "The Official Receiver should have proceeded with the debtor's "
                "rehabilitation at the end of the 6-month deadline"
            ),
            'logical_chain': [
                "1. Î†ÏÎ¸ÏÎ¿ 103: Î£Ï…Î½Î¿Ï€Ï„Î¹ÎºÎ® Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎµÎ³ÎºÏÎ¯Î½ÎµÏ„Î±Î¹",
                "2. ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143: Î ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ Ï€Î±ÏÎ±Ï„ÎµÎ¯Î½ÎµÏ„Î±Î¹ ÏƒÎµ 6 Î¼Î®Î½ÎµÏ‚",
                "3. ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143: ÎˆÎ½Î± Î¼ÏŒÎ½Î¿ Î¼Î­ÏÎ¹ÏƒÎ¼Î±",
                "4. Î†ÏÎ¸ÏÎ¿ 103(2): Î”ÎµÎ½ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚",
                "5. Î†ÏÎ¸ÏÎ¿ 27: Î•Î¾Î­Ï„Î±ÏƒÎ· Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ Ï€ÏÎ¹Î½ Ï„Î·Î½ Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·",
                "6. Î£Î¥ÎœÎ Î•Î¡Î‘Î£ÎœÎ‘: Î•Î¾Î­Ï„Î±ÏƒÎ· ÎºÎ±Î¹ Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ½Ï„ÏŒÏ‚ 6 Î¼Î·Î½ÏÎ½"
            ],
            'key_assumption': (
                "Î— Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±Ï‚ Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ ÏƒÎµ 6 Î¼Î®Î½ÎµÏ‚ ÏƒÏ…Î½ÎµÏ€Î¬Î³ÎµÏ„Î±Î¹ "
                "ÏŒÏ„Î¹ ÏŒÎ»Î· Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± (Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Î·Ï‚ Ï„Î·Ï‚ ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚) "
                "Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ ÎµÎ½Ï„ÏŒÏ‚ 6 Î¼Î·Î½ÏÎ½"
            )
        }
    
    def _generate_alternatives(self) -> List[Dict]:
        """Generate alternative legal interpretations."""
        alternatives = []
        
        # Alternative 1: Separate domains interpretation
        alternatives.append({
            'name': 'separate_domains',
            'title': 'Î•ÏÎ¼Î·Î½ÎµÎ¯Î± Î‘Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Ï‰Î½ Î¤Î¿Î¼Î­Ï‰Î½',
            'english_title': 'Separate Domains Interpretation',
            'statement': (
                "Î— Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ (6 Î¼Î®Î½ÎµÏ‚) ÎºÎ±Î¹ Î· Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ "
                "(4 Î­Ï„Î·) Î±Ï†Î¿ÏÎ¿ÏÎ½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ Î½Î¿Î¼Î¹ÎºÎ¿ÏÏ‚ Ï„Î¿Î¼ÎµÎ¯Ï‚ ÎºÎ±Î¹ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î±"
            ),
            'reasoning': [
                "ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143 Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ ÎœÎŸÎÎŸ Ï„Î¿ Î†ÏÎ¸ÏÎ¿ 58 (Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î±)",
                "Î†ÏÎ¸ÏÎ¿ 103(2) Î±Ï€Î±Î³Î¿ÏÎµÏÎµÎ¹ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· 'Î´Î¹Î±Ï„Î¬Î¾ÎµÏ‰Î½ ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚'",
                "Î¤Î¿ Î¼Î­ÏÎ¹ÏƒÎ¼Î± ÎµÎ¯Î½Î±Î¹ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ® Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±, ÏŒÏ‡Î¹ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚",
                "Î†ÏÎ¸ÏÎ¿ 28 ÏÎ·Ï„Î¬ Î´Î¯Î½ÎµÎ¹ 4ÎµÏ„Î® Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± Î³Î¹Î± Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·",
                "Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î½Î¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… ÏƒÏ…Î½Î´Î­ÎµÎ¹ Ï„Î¹Ï‚ Î´ÏÎ¿ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯ÎµÏ‚"
            ],
            'supporting_articles': ['58', '103(2)', '28', '143'],
            'strength': 'high',
            'probability': '60%'
        })
        
        # Alternative 2: Legislative intent interpretation
        alternatives.append({
            'name': 'legislative_intent',
            'title': 'Î•ÏÎ¼Î·Î½ÎµÎ¯Î± ÎÎ¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÎ®Ï‚ Î ÏÏŒÎ¸ÎµÏƒÎ·Ï‚',
            'english_title': 'Legislative Intent Interpretation',
            'statement':  (
                "ÎŸ ÏƒÎºÎ¿Ï€ÏŒÏ‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ®Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ Î· Ï„Î±Ï‡ÎµÎ¯Î± ÎµÏ€Î¯Î»Ï…ÏƒÎ· Î¼Î¹ÎºÏÏÎ½ "
                "Ï…Ï€Î¿Î¸Î­ÏƒÎµÏ‰Î½, ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹Ï„Î±Ï‡Ï…Î½Î¸Î¿ÏÎ½"
            ),
            'reasoning': [
                "Î†ÏÎ¸ÏÎ¿ 103(1): Î£Ï„ÏŒÏ‡Î¿Ï‚ 'Ï€ÎµÏÎ¹ÏƒÏ‰Î¸ÎµÎ¯ Î´Î±Ï€Î¬Î½Î· ÎºÎ±Î¹ Î±Ï€Î»Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±'",
                "ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143: Î Î¿Î»Î»Î±Ï€Î»Î­Ï‚ Î±Ï€Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î±Ï‡ÏÏ„Î·Ï„Î±",
                "ÎˆÎ½Î± Î¼ÏŒÎ½Î¿ Î¼Î­ÏÎ¹ÏƒÎ¼Î± = Î±Ï€Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·",
                "Î›Î¿Î³Î¹ÎºÏŒ Î½Î± ÎµÏ€Î¹Ï„Î±Ï‡Ï…Î½Î¸ÎµÎ¯ ÎºÎ±Î¹ Î· Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·",
                "Î¤Î¿ Î†ÏÎ¸ÏÎ¿ 28 Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚ ÏƒÎµ ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ® Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·"
            ],
            'supporting_articles': ['103(1)', '143'],
            'strength': 'medium',
            'probability': '30%'
        })
        
        # Alternative 3: Article 16(11) waiver interpretation
        alternatives.append({
            'name': 'waiver_interpretation',
            'title': 'Î•ÏÎ¼Î·Î½ÎµÎ¯Î± Î Î±ÏÎ¬Î»ÎµÎ¹ÏˆÎ·Ï‚ Î•Î¾Î­Ï„Î±ÏƒÎ·Ï‚',
            'english_title': 'Examination Waiver Interpretation',
            'statement': (
                "Î‘Î½ Î· Î´Î·Î¼ÏŒÏƒÎ¹Î± ÎµÎ¾Î­Ï„Î±ÏƒÎ· Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÏ„Î±Î¹ (Î†ÏÎ¸ÏÎ¿ 16(11)), Ï„ÏŒÏ„Îµ Î· Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± "
                "Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ Î¼Îµ Ï„Î· Î´Î¹Î±Î½Î¿Î¼Î® Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚"
            ),
            'reasoning': [
                "Î†ÏÎ¸ÏÎ¿ 16(11): Î”Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î¼Î· Î´Î¹ÎµÎ¾Î±Î³Ï‰Î³Î®Ï‚ Î´Î·Î¼ÏŒÏƒÎ¹Î±Ï‚ ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚",
                "Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ¾Î­Ï„Î±ÏƒÎ·, Ï„Î¿ Î†ÏÎ¸ÏÎ¿ 27 Î´ÎµÎ½ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ ÎºÏ…ÏÎ¹Î¿Î»ÎµÎºÏ„Î¹ÎºÎ¬",
                "Î†ÏÎ¸ÏÎ¿ 28 Î±Î½Î±Ï†Î­ÏÎµÎ¹ 'Î´Î¹Î¬Ï„Î±Î³Î¼Î± Î¼Î· Î´Î¹ÎµÎ¾Î±Î³Ï‰Î³Î®Ï‚ ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚' Ï‰Ï‚ ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ",
                "Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î· Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î­ÏÎ¹ÏƒÎ¼Î±",
                "Î©ÏƒÏ„ÏŒÏƒÎ¿, ÎµÎ¾Î±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ 4ÎµÏ„Î®Ï‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±"
            ],
            'supporting_articles': ['16(11)', '27', '28'],
            'strength': 'low',
            'probability': '10%'
        })
        
        return alternatives
    
    def _identify_principles(self) -> List[Dict]:
        """Identify statutory interpretation principles applicable."""
        principles = [
            {
                'name':  'literal_interpretation',
                'greek':  'ÎšÏ…ÏÎ¹Î¿Î»ÎµÎºÏ„Î¹ÎºÎ® Î•ÏÎ¼Î·Î½ÎµÎ¯Î±',
                'description': (
                    "Î¤Î¿ Î½Î¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎµÏÎ¼Î·Î½ÎµÏÎµÏ„Î±Î¹ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· ÏƒÏ…Î½Î®Î¸Î· ÏƒÎ·Î¼Î±ÏƒÎ¯Î± Ï„Ï‰Î½ Î»Î­Î¾ÎµÏ‰Î½"
                ),
                'application': (
                    "Î†ÏÎ¸ÏÎ¿ 103(2) Î»Î­ÎµÎ¹ 'ÎµÎ¾Î­Ï„Î±ÏƒÎ· Î® Î±Ï€Î±Î»Î»Î±Î³Î®', ÏŒÏ‡Î¹ 'Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î±'.  "
                    "ÎšÏ…ÏÎ¹Î¿Î»ÎµÎºÏ„Î¹ÎºÎ¬, Î¿ ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143 Î´ÎµÎ½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ ÎµÎ¾Î­Ï„Î±ÏƒÎ·."
                ),
                'supports_primary': False
            },
            {
                'name': 'purposive_interpretation',
                'greek': 'Î¤ÎµÎ»ÎµÎ¿Î»Î¿Î³Î¹ÎºÎ® Î•ÏÎ¼Î·Î½ÎµÎ¯Î±',
                'description': (
                    "Î¤Î¿ Î½Î¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎµÏÎ¼Î·Î½ÎµÏÎµÏ„Î±Î¹ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿Î½ ÏƒÎºÎ¿Ï€ÏŒ Ï„Î¿Ï… Î½ÏŒÎ¼Î¿Ï…"
                ),
                'application': (
                    "Î£ÎºÎ¿Ï€ÏŒÏ‚ ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ®Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚:  Ï„Î±Ï‡ÏÏ„Î·Ï„Î± ÎºÎ±Î¹ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¯Î±.  "
                    "Î‘Ï…Ï„ÏŒ Î¸Î± Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¶Îµ Ï„Î±Ï‡ÎµÎ¯Î± Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·."
                ),
                'supports_primary': True
            },
            {
                'name': 'harmonious_interpretation',
                'greek':  'Î‘ÏÎ¼Î¿Î½Î¹ÎºÎ® Î•ÏÎ¼Î·Î½ÎµÎ¯Î±',
                'description': (
                    "ÎŸÎ¹ Î´Î¹Î±Ï„Î¬Î¾ÎµÎ¹Ï‚ ÎµÏÎ¼Î·Î½ÎµÏÎ¿Î½Ï„Î±Î¹ ÏÏƒÏ„Îµ Î½Î± Î±Ï€Î¿Ï†ÎµÏ…Ï‡Î¸Î¿ÏÎ½ Î±Î½Ï„Î¹Ï†Î¬ÏƒÎµÎ¹Ï‚"
                ),
                'application': (
                    "Î†ÏÎ¸ÏÎ¿ 103(2) ÎºÎ±Î¹ ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143 Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¹Î±Î²Î±ÏƒÏ„Î¿ÏÎ½ Î±ÏÎ¼Î¿Î½Î¹ÎºÎ¬.  "
                    "Î— Î´Î¹Î¬ÎºÏÎ¹ÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï 'ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚' ÎºÎ±Î¹ 'Î¼ÎµÏÎ¹ÏƒÎ¼Î¬Ï„Ï‰Î½' ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î±Ï…Ï„ÏŒ."
                ),
                'supports_primary': False
            },
            {
                'name': 'expressio_unius',
                'greek': 'Expressio Unius Est Exclusio Alterius',
                'description': (
                    "Î— ÏÎ·Ï„Î® Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÎµ Î­Î½Î± Ï€ÏÎ¬Î³Î¼Î± ÎµÎ¾Î±Î¹ÏÎµÎ¯ Ï„Î± Î¬Î»Î»Î±"
                ),
                'application': (
                    "Î†ÏÎ¸ÏÎ¿ 103(2) ÏÎ·Ï„Î¬ Î±Ï€Î±Î³Î¿ÏÎµÏÎµÎ¹ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· 'ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚ Î® Î±Ï€Î±Î»Î»Î±Î³Î®Ï‚'. "
                    "Î¤Î¿ ÏŒÏ„Î¹ Î´ÎµÎ½ Î±Î½Î±Ï†Î­ÏÎµÎ¹ 'Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î±' ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î± Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î± ÎœÎ ÎŸÎ¡ÎŸÎ¥Î "
                    "Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½."
                ),
                'supports_primary': False
            },
            {
                'name': 'implied_terms',
                'greek': 'Î£Î¹Ï‰Ï€Î·ÏÎ­Ï‚ Î ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚',
                'description': (
                    "ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚ Ï…Ï€Î¿Î½Î¿Î¿ÏÎ½Ï„Î±Î¹ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Î´ÎµÎ½ Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏÎ·Ï„Î¬"
                ),
                'application': (
                    "Î— ÎµÏÎ¼Î·Î½ÎµÎ¯Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Î· 6Î¼Î·Î½Î· Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± ÏƒÎ¹Ï‰Ï€Î·ÏÎ¬ Ï…Ï€Î¿Ï‡ÏÎµÏÎ½ÎµÎ¹ "
                    "Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·, Î±Î»Î»Î¬ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏÎ·Ï„ÏŒ."
                ),
                'supports_primary': True
            }
        ]
        
        return principles
    
    def _identify_ambiguities(self) -> List[Dict]:
        """Identify key ambiguities in the interpretation."""
        ambiguities = [
            {
                'issue': 'Î ÎµÎ´Î¯Î¿ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ "Î´Î¹Î±Ï„Î¬Î¾ÎµÏ‰Î½ ÎµÎ¾Î­Ï„Î±ÏƒÎ·Ï‚"',
                'english': 'Scope of "examination provisions"',
                'question': (
                    "Î¤Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÎµÎ½Î½Î¿ÎµÎ¯ Ï„Î¿ Î†ÏÎ¸ÏÎ¿ 103(2) Î¼Îµ 'Î´Î¹Î±Ï„Î¬Î¾ÎµÎ¹Ï‚ Ï€Î¿Ï… Î±Ï†Î¿ÏÎ¿ÏÎ½ "
                    "Ï„Î·Î½ ÎµÎ¾Î­Ï„Î±ÏƒÎ·'; Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï‡ÏÎ¿Î½Î¿Î´Î¹Î±Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Î¼ÎµÏÎ¹ÏƒÎ¼Î¬Ï„Ï‰Î½;"
                ),
                'importance': 'critical',
                'current_status': 'unresolved',
                'resolution_needed': 'ÎÎ¿Î¼Î¿Î»Î¿Î³Î¯Î± Î® Î½Î¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÎ® Î´Î¹ÎµÏ…ÎºÏÎ¯Î½Î¹ÏƒÎ·'
            },
            {
                'issue':  'Î£Ï‡Î­ÏƒÎ· 6Î¼Î·Î½Î·Ï‚ ÎºÎ±Î¹ 4ÎµÏ„Î¿ÏÏ‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±Ï‚',
                'english': 'Relationship between 6-month and 4-year deadlines',
                'question': (
                    "Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ Î¿ ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ 143 ÏƒÎ¹Ï‰Ï€Î·ÏÎ¬ Ï„Î¿ Î†ÏÎ¸ÏÎ¿ 28, Î® ÎµÎ¯Î½Î±Î¹ "
                    "Ï„Î± Î´ÏÎ¿ Ï‡ÏÎ¿Î½Î¿Î´Î¹Î±Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î±;"
                ),
                'importance': 'high',
                'current_status': 'conflicting',
                'resolution_needed': 'Î™ÎµÏÎ±ÏÏ‡Î¹ÎºÎ® ÏƒÏ‡Î­ÏƒÎ· ÎºÎ±Î½ÏŒÎ½Ï‰Î½'
            },
            {
                'issue': 'Î¥Ï€Î¿Ï‡ÏÎ­Ï‰ÏƒÎ· vs Î”Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ® Î•Ï…Ï‡Î­ÏÎµÎ¹Î±',
                'english': 'Obligation vs Discretion',
                'question': (
                    "Î— 6Î¼Î·Î½Î· Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Ï…Ï€Î¿Ï‡ÏÎ­Ï‰ÏƒÎ· Î® Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ® "
                    "ÎµÏ…Ï‡Î­ÏÎµÎ¹Î± ÏƒÏ„Î¿Î½ Î•Ï€Î¯ÏƒÎ·Î¼Î¿ Î Î±ÏÎ±Î»Î®Ï€Ï„Î·;"
                ),
                'importance': 'high',
                'current_status':  'ambiguous',
                'resolution_needed': 'Î‘Î½Î¬Î»Ï…ÏƒÎ· Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÎºÎ®Ï‚ ("Î´ÏÎ½Î±Ï„Î±Î¹" vs "Ï€ÏÎ­Ï€ÎµÎ¹")'
            },
            {
                'issue': 'ÎˆÎ½Î½Î¿Î¹Î± "Î­Î½Î± Î¼ÏŒÎ½Î¿ Î¼Î­ÏÎ¹ÏƒÎ¼Î±"',
                'english': 'Meaning of "single dividend"',
                'question': (
                    "Î¤Î¿ 'Î­Î½Î± Î¼ÏŒÎ½Î¿ Î¼Î­ÏÎ¹ÏƒÎ¼Î±' ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ® Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ· Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„ÎµÎ¯ "
                    "Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·, Î® Î±Ï€Î»Î¬ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ® Î±Ï€Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·;"
                ),
                'importance': 'medium',
                'current_status': 'interpretive',
                'resolution_needed': 'Î£ÎºÎ¿Ï€ÏŒÏ‚ Î½Î¿Î¼Î¿Î¸ÎµÏƒÎ¯Î±Ï‚'
            }
        ]
        
        return ambiguities
    
    def _generate_recommendations(self) -> List[Dict]:
        """Generate recommendations for resolving the interpretation."""
        recommendations = [
            {
                'priority': 1,
                'type': 'case_law_research',
                'title': 'ÎˆÏÎµÏ…Î½Î± ÎÎ¿Î¼Î¿Î»Î¿Î³Î¯Î±Ï‚',
                'description': (
                    "Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î±Ï€Î¿Ï†Î¬ÏƒÎµÏ‰Î½ Ï€Î¿Ï… ÎµÏÎ¼Î·Î½ÎµÏÎ¿Ï…Î½ Ï„Î¿ Î†ÏÎ¸ÏÎ¿ 103(2) ÎºÎ±Î¹ "
                    "Ï„Î¿Î½ ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒ 143 ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Ï…Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ®Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚"
                ),
                'sources': [
                    'Î‘Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ Î•Ï€Î±ÏÏ‡Î¹Î±ÎºÎ¿Ï Î”Î¹ÎºÎ±ÏƒÏ„Î·ÏÎ¯Î¿Ï… ÎšÏÏ€ÏÎ¿Ï…',
                    'Î‘Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ Î‘Î½ÏÏ„Î±Ï„Î¿Ï… Î”Î¹ÎºÎ±ÏƒÏ„Î·ÏÎ¯Î¿Ï… (ÎµÏ†Î­ÏƒÎµÎ¹Ï‚)',
                    'Î Î±ÏÏŒÎ¼Î¿Î¹ÎµÏ‚ Ï…Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î· Commonwealth Î½Î¿Î¼Î¿Î»Î¿Î³Î¯Î±'
                ]
            },
            {
                'priority': 2,
                'type': 'legislative_history',
                'title': 'ÎÎ¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÏŒ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ',
                'description': (
                    "Î•Î¾Î­Ï„Î±ÏƒÎ· Ï„Î·Ï‚ Î½Î¿Î¼Î¿Î¸ÎµÏ„Î¹ÎºÎ®Ï‚ Ï€ÏÏŒÎ¸ÎµÏƒÎ·Ï‚ ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÏˆÎ®Ï†Î¹ÏƒÎ· Ï„Î¿Ï… "
                    "ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼Î¿Ï 143 Ï„Î¿ 1931"
                ),
                'sources': [
                    'Î ÏÎ±ÎºÏ„Î¹ÎºÎ¬ Î’Î¿Ï…Î»Î®Ï‚',
                    'Î•Ï€ÎµÎ¾Î·Î³Î·Î¼Î±Ï„Î¹ÎºÎ¬ Î¥Ï€Î¿Î¼Î½Î®Î¼Î±Ï„Î±',
                    'Î”ÎµÏ…Ï„ÎµÏÎ¿Î³ÎµÎ½Î® Î½Î¿Î¼Î¹ÎºÎ¬ ÎºÎµÎ¯Î¼ÎµÎ½Î±'
                ]
            },
            {
                'priority': 3,
                'type': 'comparative_analysis',
                'title': 'Î£Ï…Î³ÎºÏÎ¹Ï„Î¹ÎºÎ® Î‘Î½Î¬Î»Ï…ÏƒÎ·',
                'description': (
                    "Î•Î¾Î­Ï„Î±ÏƒÎ· Ï€ÏÏ‚ Î¬Î»Î»ÎµÏ‚ Î´Î¹ÎºÎ±Î¹Î¿Î´Î¿ÏƒÎ¯ÎµÏ‚ (UK, Commonwealth) Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ "
                    "Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î¶Î·Ï„Î®Î¼Î±Ï„Î± ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ®Ï‚ Ï€Ï„Ï‰Ï‡ÎµÏ…Ï„Î¹ÎºÎ®Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚"
                ),
                'sources': [
                    'UK Insolvency Act 1986',
                    'UK Insolvency Rules',
                    'Î‘Ï…ÏƒÏ„ÏÎ±Î»Î¹Î±Î½ÏŒ Ï€Ï„Ï‰Ï‡ÎµÏ…Ï„Î¹ÎºÏŒ Î´Î¯ÎºÎ±Î¹Î¿'
                ]
            },
            {
                'priority': 4,
                'type': 'expert_opinion',
                'title': 'Î“Î½Ï‰Î¼Î¿Î´ÏŒÏ„Î·ÏƒÎ· Î•Î¹Î´Î¹ÎºÎ¿Ï',
                'description': (
                    "Î›Î®ÏˆÎ· Î³Î½Ï‰Î¼Î¿Î´ÏŒÏ„Î·ÏƒÎ·Ï‚ Î±Ï€ÏŒ ÎµÎ¹Î´Î¹ÎºÎ¿ÏÏ‚ ÏƒÏ„Î¿ Ï€Ï„Ï‰Ï‡ÎµÏ…Ï„Î¹ÎºÏŒ Î´Î¯ÎºÎ±Î¹Î¿ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ "
                    "Î¼Îµ Ï„Î·Î½ ÎµÏÎ¼Î·Î½ÎµÎ¯Î± Ï„Î¿Ï… Î†ÏÎ¸ÏÎ¿Ï… 103(2)"
                ),
                'sources': [
                    'Î Ï„Ï‰Ï‡ÎµÏ…Ï„Î¹ÎºÎ¿Î¯ Î£ÏÎ½Î´Î¹ÎºÎ¿Î¹ Î¼Îµ ÎµÎ¼Ï€ÎµÎ¹ÏÎ¯Î±',
                    'ÎÎ¿Î¼Î¹ÎºÎ¿Î¯ Î±ÎºÎ±Î´Î·Î¼Î±ÏŠÎºÎ¿Î¯',
                    'Î ÏÎ±ÎºÏ„Î¹ÎºÎ¿Î¯ Î´Î¹ÎºÎ·Î³ÏŒÏÎ¿Î¹ Ï€Ï„Ï‰Ï‡ÎµÏ…Ï„Î¹ÎºÎ¿Ï Î´Î¹ÎºÎ±Î¯Î¿Ï…'
                ]
            },
            {
                'priority':  5,
                'type':  'official_receiver_practice',
                'title': 'Î ÏÎ±ÎºÏ„Î¹ÎºÎ® Î•Ï€Î¯ÏƒÎ·Î¼Î¿Ï… Î Î±ÏÎ±Î»Î®Ï€Ï„Î·',
                'description': (
                    "Î”Î¹ÎµÏÎµÏÎ½Î·ÏƒÎ· Ï„Î·Ï‚ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ®Ï‚ Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ®Ï‚ Ï„Î¿Ï… Î•Ï€Î¯ÏƒÎ·Î¼Î¿Ï… Î Î±ÏÎ±Î»Î®Ï€Ï„Î· "
                    "ÏƒÎµ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Ï…Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ®Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚"
                ),
                'sources': [
                    'Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î±Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÏ‰Î½',
                    'Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ ÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½Ï„Î®ÏÎ¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚',
                    'Î ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Î±Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ ÏƒÎµ Ï€Î±ÏÏŒÎ¼Î¿Î¹ÎµÏ‚ Ï…Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚'
                ]
            }
        ]
        
        return recommendations


if __name__ == '__main__': 
    # Test
    from legal_parser import LegalParser
    from cross_reference_analyzer import CrossReferenceAnalyzer
    
    parser = LegalParser(verbose=True)
    articles = parser.load_all_articles()
    
    analyzer = CrossReferenceAnalyzer(articles, verbose=True)
    graph = analyzer.build_graph()
    
    engine = ReasoningEngine(articles, graph, verbose=True)
    results = engine.analyze()
    
    print(f"\nğŸ“Š Î‘Î ÎŸÎ¤Î•Î›Î•Î£ÎœÎ‘Î¤Î‘ ÎÎŸÎœÎ™ÎšÎ—Î£ Î•Î¡ÎœÎ—ÎÎ•Î™Î‘Î£")
    print("=" * 70)
    
    print(f"\nÎ Î¡Î©Î¤ÎŸÎ“Î•ÎÎ—Î£ Î•Î¡ÎœÎ—ÎÎ•Î™Î‘:")
    print(results['primary_interpretation']['statement'])
    
    print(f"\n\nÎ•ÎÎ‘Î›Î›Î‘ÎšÎ¤Î™ÎšÎ•Î£ Î•Î¡ÎœÎ—ÎÎ•Î™Î•Î£ ({len(results['alternatives'])}):")
    for alt in results['alternatives']:
        print(f"\n{alt['title']} (Î Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„Î±: {alt['probability']})")
        print(f"  {alt['statement']}")
    
    print(f"\n\nÎšÎ¡Î™Î£Î™ÎœÎ•Î£ Î‘Î£Î‘Î¦Î•Î™Î•Î£ ({len(results['ambiguities'])}):")
    for amb in results['ambiguities']: 
        print(f"\nâ€¢ {amb['issue']}")
        print(f"  Î•ÏÏÏ„Î·Î¼Î±: {amb['question']}")